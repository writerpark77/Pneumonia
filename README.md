#  폐렴 예측 및 병변 확인

## 프로젝트 개요
이 프로젝트는 폐렴 분류 문제를 해결하기 위해 설계된 딥러닝 모델을 포함하고 있으며, 주어진 폐 엑스레이 이미지를 분석하여 환자의 폐렴 여부를 분류한다. PyTorch를 활용한 CNN 모델을 기반으로 데이터 전처리, 학습, 평가 과정하고 폐렴 병변을ㄹ 시각화 하는 프로젝트이다.

## 데이터 정보
- **데이터셋**: 5863장의 폐 엑스레이 이미지로 구성된 데이터셋
  - 클래스: 폐렴 환자, 정상인 두 가지로 분류됨
  - 출처: [Kaggle - Chest X-ray Pneumonia](https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia)
- **데이터 특징**:
  - 이미지 크기: 224x224로 전처리
  - 데이터 증강: 회전, 확대, 플립 등 다양한 변환 기법 적용

## 데이터 전처리
데이터는 PyTorch의 `Dataset` 클래스를 활용하여 전처리 단계
1. 이미지를 224x224 픽셀로 리사이즈
2. Tensor 형식으로 변환
3. 정규화를 통해 픽셀 값을 [0, 1] 범위로 조정

## 모델 설명
- **CNN 아키텍처**:
  - Convolutional Layer: 이미지 특징 추출
  - MaxPooling Layer: 차원 축소 및 주요 특징 보존
  - Fully Connected Layer: 분류 작업 수행
  - Dropout: 과적합 방지

- **모델 변형**:
  - 다양한 CNN 구조 실험 (e.g., Conv3, Conv4)
  - 레이어 수와 파라미터를 조정하여 최적화

- **손실 함수 및 최적화 기법**:
  - 손실 함수: Cross-Entropy Loss
  - 최적화 알고리즘: Adam Optimizer


## 학습 및 결과
1. **훈련 과정**:
   - 10 Epoch 동안 학습 수행
   - 학습 및 검증 데이터셋의 정확도와 손실 값 기록

2. **결과 시각화**:
   - 학습 손실(Cross-Entropy Loss)과 정확도 그래프
   - 여러 모델 구조 간 성능 비교 (e.g., Conv3, Conv4)

3. **테스트 데이터 평가**:
   - 최종 모델은 테스트 데이터셋에서 87.5%의 정확도를 기록

4. **병변 강조 시각화**:
   - 모델이 병변으로 추정한 영역을 시각적으로 강조하기 위해 Grad-CAM(Gradient-weighted Class Activation Mapping)을 사용
   - 병변 영역을 더욱 선명하게 표현하기 위해 강조 색상을 적용하였으며, 해당 영역을 빨간색으로 시각화하여 해석 가능성을 높힘

## 주요 시각화 결과
- **손실 값 변화**:
  학습이 진행됨에 따라 손실 값이 점진적으로 감소
- **정확도 변화**:
  학습 정확도와 검증 정확도가 지속적으로 향상됨
- **모델 비교**:
  Conv4 모델이 가장 우수한 성능을 보여줌
- **병변 강조 결과**:
  모델이 예측한 병변 영역이 정확히 폐렴으로 나타나는 경우가 많았으며, 잘못 예측한 경우에 대한 분석도 포함하였습니다.


이 README는 주어진 폐렴 분류 프로젝트의 세부 내용을 설명하며, 데이터 준비부터 모델 학습 및 평가까지의 전 과정을 포함합니다. 자세한 구현 내용은 Jupyter Notebook 파일을 참조하십시오.



